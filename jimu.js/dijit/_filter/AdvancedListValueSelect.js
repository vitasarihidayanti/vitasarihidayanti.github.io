// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"url:jimu/dijit/_filter/AdvancedListValueSelect.html":'\x3cdiv class\x3d"jimu-list-multiple-select" data-dojo-attach-point\x3d"multipleSelect" \x3e\r\n  \x3cdiv class\x3d"selectedContainer" data-dojo-attach-point\x3d"selectedContainer"\x3e\r\n    \x3cdiv class\x3d"jimu-multiple-items-list" data-dojo-attach-point\x3d"selectedListContent"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv\x3e\r\n    \x3c!-- \x3cdiv style\x3d"position:absolute;height:345px;width:100%;z-index:1;display:none;" data-dojo-attach-point\x3d"listContainerOverlay"\x3e\x3c/div\x3e --\x3e\r\n    \x3cdiv class\x3d"searchKeyInput" data-dojo-attach-point\x3d"searchKeyInput" style\x3d"display:none;"\x3e\r\n      \x3cinput value\x3d"" placeholder\x3d"${jimuCommonNls.search}" data-dojo-type\x3d"dijit/form/ValidationTextBox"\r\n       data-dojo-attach-point\x3d"valueInput" data-dojo-props\x3d\'"required":false,intermediateChanges:true\' style\x3d"width:100%;" /\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"items-content loading-center" data-dojo-attach-point\x3d"listContainer"\x3e\r\n      \x3c!-- \x3cdiv data-dojo-attach-point\x3d"listContentStore"style\x3d"height:1px;visibility:hidden;overflow:hidden;"\x3e\r\n      \x3c/div\x3e --\x3e\r\n      \x3cdiv class\x3d"jimu-multiple-items-list" data-dojo-attach-point\x3d"listContent"\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"loadMoreDataBtn" class\x3d"jimu-list-multiple-select-Tips load-more-data-Tips"\x3e${jimuCommonNls.searchMore}\x3c/div\x3e\r\n      \x3c!-- \x3cdiv data-dojo-attach-point\x3d"noDataTips" class\x3d"jimu-list-multiple-select-Tips no-data-Tips"\x3e${Nls.noData}\x3c/div\x3e --\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"noDataTips" class\x3d"jimu-list-multiple-select-Tips no-data-Tips"\x3e${noDataNls}\x3c/div\x3e\r\n      \x3c!-- \x3cdiv class\x3d"createNewItem" data-dojo-attach-point\x3d"createNewItem" data-dojo-attach-event\x3d"click:_createTarget"\x3e\x26nbsp;\x3c/div\x3e --\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3c!--\r\n  \x3cdiv class\x3d"selectedToggleDiv" style\x3d"display:none;" data-dojo-attach-point\x3d"selectedToggleDiv"\x3e\r\n    \x3cspan class\x3d"selectedToggle" data-dojo-attach-point\x3d"selectedToggle"\x3e\x3c/span\x3e\r\n    \x3cspan class\x3d"toggleTxt" title\x3d"${Nls.showSelected}"\x3e${Nls.showSelected}\x3c/span\x3e\r\n  \x3c/div\x3e\r\n  --\x3e\r\n\r\n  \x3cdiv class\x3d"selectedToggleDiv" style\x3d"display:none;" data-dojo-attach-point\x3d"selectedToggleDiv"\x3e\r\n      \x3cdiv class\x3d"showAllIcon iconHover jimu-flipx" title\x3d"${Nls.showAll}"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"showSelectedIcon jimu-flipx" title\x3d"${Nls.showSelected}"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"clearAllSelectedIcon jimu-flipx" title\x3d"${Nls.unCheckAll}" data-dojo-attach-point\x3d"clearAllSelectedBtn"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e'}});
define("dojo/_base/lang dojo/Evented dojo/_base/html dojo/_base/declare dijit/_WidgetBase dojo/on dojo/query dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./AdvancedListValueSelect.html jimu/utils".split(" "),function(g,m,c,p,q,h,k,r,t,u,v){return p([q,r,t,m],{templateString:u,selectType:null,dataList:[],checkedList:[],checkedLabelList:[],_itemLabelW:215,ifFristPage:!0,queryState:!0,isCacheFinish:!1,keyQueryMode:!1,cacheQueryMode:!1,emptyStr:"",postMixInProperties:function(){this.inherited(arguments);
this.jimuCommonNls=window.jimuNls.common;this.Nls=window.jimuNls.filterBuilder;this.noDataNls=window.apiNls.widgets.FeatureTable.noData},postCreate:function(){this.inherited(arguments);this.inputType="unique"===this.selectType?"radio":"checkbox";if("multipleDynamic"===this.controlType||"uniqueDynamic"===this.controlType)c.addClass(this.listContainer,"items-setting-dropdown-content"),this.searchKeyInput.style.display="block";"uniqueDynamic"===this.controlType&&c.addClass(this.listContainer,"items_content_no_selected_toggle");
this.runtime?(c.addClass(this.listContainer,"items-widget-content"),"dropdown"!==this.selectUI&&(c.addClass(this.listContainer,"items-widget-expaned-content"),c.addClass(this.listContent,"jimu-multiple-items-expanded-list"))):(c.addClass(this.listContainer,"items-setting-popup-content"),this.searchKeyInput.style.display="block");this.runtime||"predefined"!==this.controlType||(c.addClass(this.listContainer,"items-setting-dropdown-content"),c.addClass(this.listContainer,"items_content_no_selected_toggle"),
this.searchKeyInput.style.display="block");this._addCBXClickEvent();("dropdown"===this.selectUI||"predefined"===this.controlType&&!this.runtime)&&this._addCBXHoverEvent();this.disPlayLabel="value";!this.runtime||"multiplePredefined"!==this.controlType&&"uniquePredefined"!==this.controlType||(this.disPlayLabel="alias");"multipleDynamic"===this.controlType&&(this.selectedToggleDiv.style.display="block",this.selectedToggle=k(".showAllIcon",this.selectedToggleDiv)[0],this.own(h(this.selectedToggleDiv,
"click",g.hitch(this,"_toggleFilter"))),this._addSelectedContainerEvent())},_toggleFilter:function(a){var b=a.target;c.hasClass(b,"clearAllSelectedIcon")?this._clearAllSelected():c.hasClass(b,"iconHover")||c.hasClass(b,"selectedToggleDiv")||(c.hasClass(b,"showAllIcon")?this.selectedContainer.style.display="none":(this._initSelectedContainerItems(),this.selectedContainer.style.display="block"),c.removeClass(this.selectedToggle,"iconHover"),this.selectedToggle=b,c.addClass(this.selectedToggle,"iconHover"),
a.stopPropagation())},showAllList:function(){c.hasClass(this.selectedToggle,"showSelectedIcon")&&c.hasClass(this.selectedToggle,"iconHover")&&(c.removeClass(this.selectedToggle,"iconHover"),this.selectedToggle=k(".showAllIcon",this.selectedToggleDiv)[0],c.addClass(this.selectedToggle,"iconHover"),c.setStyle(this.selectedContainer,"display","none"))},_clearAllSelected:function(){var a;a=c.hasClass(this.selectedToggle,"showAllIcon")?this.listContainer:this.selectedListContent;a=k(".item .checkInput.checked",
a);for(var b=0;b<a.length;b++)a[b].click()},_initSelectedContainerItems:function(){for(var a=this.selectedListContent.innerHTML="",b=this.runtime?" labelRuntime":"",d=0;d<this.checkedList.length;d++)var c=this.checkedList[d],a=a+('\x3cdiv class\x3d"item"\x3e\x3cdiv class\x3d"checkInput '+this.inputType+' checked" '+(this.isNumberField?"data\x3d"+c:"data\x3d'"+c+"'")+'\x3e\x3c/div\x3e\x3cdiv class\x3d"label jimu-ellipsis-Blanks'+b+'" style\x3d"max-width:'+this._itemLabelW+'px"\x3e'+("value"===this.disPlayLabel?
c:this.checkedLabelList[d])+"\x3c/div\x3e\x3c/div\x3e");this.selectedListContent.innerHTML=a},_addSelectedContainerEvent:function(){this.own(h(this.selectedListContent,"click",g.hitch(this,function(a){var b=a.target,d;if(c.hasClass(b,"item"))d=b.firstElementChild,b=b.firstElementChild.nextSibling;else if(c.hasClass(b,"checkInput"))d=b,b=b.nextSibling;else if(c.hasClass(b,"label"))d=b.previousSibling;else{a.stopPropagation();return}var e=b=this._getNodeText(b);if("alias"===this.disPlayLabel||"label"===
this.disPlayLabel)e=decodeURIComponent(c.getAttr(d,"data"));if(c.hasClass(d,"checked")){if("radio"===this.inputType)return;c.removeClass(d,"checked");this._updateCheckedList("remove",e,b);this.checkCBXItems();this.emit("advancedListValueSelect_itemUnChecked",b)}else"radio"===this.inputType&&this.currentItem&&(!0===this.currentItem&&(this.currentItem=this.getCurrentItem()),c.removeClass(this.currentItem,"checked")),c.addClass(d,"checked"),this._updateCheckedList("add",e,b),this.checkCBXItems(),this.emit("advancedListValueSelect_itemChecked",
b);a.stopPropagation()})))},_getNodeText:function(a){return a.textContent||a.innerText||""},_updateCheckedList:function(a,b,d){b!==this.emptyStr&&(b=this.isNumberField?parseFloat(b):b);if("remove"===a)for(var c in this.checkedList){if(this.checkedList[c]===b||this.isNumberField&&isNaN(this.checkedList[c])&&isNaN(b)){this.checkedList.splice(c,1);this.checkedLabelList.splice(c,1);break}}else"radio"===this.inputType?(this.checkedList=[b],this.checkedLabelList=[d]):(this.checkedList.push(b),this.checkedLabelList.push(d))},
_updateCheckedLabelList:function(a){this.checkedLabelList=[];for(var b=0;b<this.checkedList.length;b++)for(var d=0;d<a.length;d++)this.checkedList[b]===a[d].value&&this.checkedLabelList.push(a[d].label)},_updateCheckedLabelListFromCheckedList:function(){for(var a=0;a<this.checkedList.length;a++)this.checkedLabelList.push(this.checkedList[a]+"")},_createTarget:function(a){a=this._getNodeText(a.target).split(": ")[1];this.emit("advancedListValueSelect_itemChecked",a)},_deleteCBXItem:function(){},_getCheckInputItems:function(){return k(".item .checkInput",
this.listContent)},getListCheckedValuesOrigin:function(){for(var a=[],b=this._getCheckInputItems(),d=0;d<b.length;d++){var e=b[d],f=this._getNodeText(e.nextSibling);c.hasClass(e,"checked")&&a.push(f)}return a},getListCheckedValues:function(){for(var a=[],b=g.clone(this.checkedList),d=0;d<b.length;d++){var c=b[d],c=this.isNumberField?parseFloat(c):c;a.push(c)}return a},getListValues:function(){var a=[],b=this._getCheckInputItems();if(0===b.length)return this.dataList;for(var d=0;d<b.length;d++){var e=
b[d],f=this._getNodeText(e.nextSibling);if("alias"===this.disPlayLabel||"label"===this.disPlayLabel)f=decodeURIComponent(c.getAttr(e,"data"));f=this.isNumberField?parseFloat(f):f;f={value:f,isChecked:!1};c.hasClass(e,"checked")&&(f.isChecked=!0);a.push(f)}return a},getIfValueExist:function(a){for(var b=this._getCheckInputItems(),c=0;c<b.length;c++){var e=this._getNodeText(b[c].nextSibling);if(a===e)return!0}return!1},getCurrentItem:function(){for(var a=this._getCheckInputItems(),b=0;b<a.length;b++){var d=
a[b];if(c.hasClass(d,"checked"))return d}return null},checkCBXItems:function(a){a=a?"":this.valueInput.get("value");this.valueInput.set("value",a);a=k(".item .label",this.listContent);for(var b=0;b<a.length;b++){var d=a[b],e="value"===this.disPlayLabel?this._getNodeText(d):decodeURIComponent(c.getAttr(d.previousSibling,"data")),e=this.isNumberField?parseFloat(e):e;0<=this.checkedList.indexOf(e)||this.isNumberField&&0<=this.checkedList.indexOf(parseFloat(e))?c.addClass(d.previousSibling,"checked"):
c.removeClass(d.previousSibling,"checked")}},reset:function(){this.listContent.innerHTML=""},setCBXData:function(a,b,d,e){e||(this.queryState=!1);a=a?a:[];if(this.listContent){c.setStyle(this.noDataTips,"display","none");var f=0,g="radio"===this.inputType?" labelBig":"",h=this.runtime?" labelRuntime":"";e=this.listContent.innerHTML;if(d){e=this.listContent.innerHTML="";if("uniquePredefined"===this.controlType&&this.enableEmpty||"uniqueDynamic"===this.controlType&&!this.keyQueryMode)d=e="",this.checkedList[0]===
this.emptyStr&&(e=" checked",d=" active",f=1),0===this.checkedList.length&&(e=" checked",this.currentItem=!0,f=1),e='\x3cdiv class\x3d"item emptyItem'+d+'"\x3e\x3cdiv class\x3d"checkInput '+this.inputType+e+'" '+("data\x3d'"+this.emptyStr+"'")+'\x3e\x3c/div\x3e\x3cdiv class\x3d"label'+g+" jimu-ellipsis-Blanks"+h+'" style\x3d"max-width:'+this._itemLabelW+'px"\x3e'+this.emptyStr+"\x3c/div\x3e\x3c/div\x3e";this.listContainer.scrollTop=0}if(0===a.length)return a=this.listContent.innerHTML.replace(/(^\s*)|(\s*$)/g,
""),""!==a||this.cacheQueryMode&&!this.isCacheFinish||c.setStyle(this.noDataTips,"display","block"),""===a&&(this.listContent.innerHTML=e),this.listContent;d="";for(var k=0;k<a.length;k++){var l=a[k],n="";if(b)if(this.runtime&&("multiplePredefined"===this.controlType||"uniquePredefined"===this.controlType))l.isChecked&&(n=" checked",this.currentItem=!0,f++);else if(0<=this.checkedList.indexOf(l.value)||this.isNumberField&&0<=this.checkedList.indexOf(parseFloat(l.value)))n=" checked",this.currentItem=
!0,f++;var m='data\x3d"'+(this.isNumberField?l.value:encodeURIComponent(l.value))+'"';d+='\x3cdiv class\x3d"item"\x3e\x3cdiv class\x3d"checkInput '+this.inputType+n+'" '+m+'\x3e\x3c/div\x3e\x3cdiv class\x3d"label'+g+" jimu-ellipsis-Blanks"+h+'" style\x3d"max-width:'+this._itemLabelW+'px"\x3e'+l[this.disPlayLabel]+"\x3c/div\x3e\x3c/div\x3e"}a=this.checkedList.length-f;if(this.runtime&&0<a)for(b=0;b<a;b++)this.emit("advancedListValueSelect_itemUnChecked","");this.listContent.innerHTML=e+d;return this.listContent}},
setCBXContentBySearch:function(a,b){0===a.length?this.setCBXData([],!1,!0,b):this.setCBXData(a,!0,!0,b)},_onSearchKeyChange:function(){var a=this.valueInput.get("value");this.searchName=a;this.listContainer.scrollTop=0;this.reset();this.cacheQueryMode=this.keyQueryMode=this.ifFristPage=!0;this.emit("advancedListValueSelect_searchKeyLocal",a);this.codedValues||(this.isCacheFinish||c.setStyle(this.loadMoreDataBtn,"display","block"),0===a.length&&(this.queryState=this.cacheQueryMode=this.keyQueryMode=
!1,c.setStyle(this.loadMoreDataBtn,"display","none")))},_loadMoreDataFromServer:function(){this.keyQueryMode=this.ifFristPage=!0;this.cacheQueryMode=!1;this.queryState=!0;c.setStyle(this.loadMoreDataBtn,"display","none");var a=this.valueInput.get("value");this.searchName=a;this.listContainer.scrollTop=0;"multipleDynamic"===this.controlType||"uniqueDynamic"===this.controlType?this.emit("advancedListValueSelect_searchKey",a):this.runtime||this.emit("advancedListValueSelect_searchKey",a)},currentHoverItem:null,
_addCBXHoverEvent:function(){this.own(h(this.listContent,"mouseover",g.hitch(this,function(a){a=a.target||a.srcElement;a=c.hasClass(a,"item")?a:v.getAncestorDom(a,function(a){return c.hasClass(a,"item")},3);this.currentHoverItem&&c.removeClass(this.currentHoverItem,"active");c.addClass(a,"active");this.currentHoverItem=a})));this.own(h(this.listContent,"mouseout",g.hitch(this,function(){this.currentHoverItem&&c.removeClass(this.currentHoverItem,"active");this.currentHoverItem=null})))},_addCBXClickEvent:function(){this.own(h(this.valueInput,
"change",g.hitch(this,function(){this._onSearchKeyChange()})));this.own(h(this.loadMoreDataBtn,"click",g.hitch(this,function(){this._loadMoreDataFromServer()})));this.own(h(this.listContainer,"scroll",g.hitch(this,this.dropDownScroll)));this.own(h(this.searchKeyInput,"click",g.hitch(this,function(a){a.stopPropagation()})));this.own(h(this.listContainer,"click",g.hitch(this,function(a){var b=a.target,d;if(c.hasClass(b,"item"))d=b.firstElementChild,b=b.firstElementChild.nextSibling;else if(c.hasClass(b,
"checkInput"))d=b,b=b.nextSibling;else if(c.hasClass(b,"label"))d=b.previousSibling;else{a.stopPropagation();return}this._setCBXChecked(d,this._getNodeText(b));a.stopPropagation()})))},scrollDiff:100,dropDownScroll:function(a){this.runtime&&("uniquePredefined"===this.controlType||"multiplePredefined"===this.controlType)||this.cacheQueryMode||this.codedValues||(this.queryState?this.listContainer.scrollTop=this.containerScrollTop:(a=a.target,a.scrollHeight-a.clientHeight-a.scrollTop<=this.scrollDiff&&
!this.queryState&&(this.containerScrollTop=this.listContainer.scrollTop,this.queryState=!0,this.ifFristPage=!1,this.emit("advancedListValueSelect_addNextPage"))))},_setCBXChecked:function(a,b){var d=b;if("alias"===this.disPlayLabel||"label"===this.disPlayLabel)d=decodeURIComponent(c.getAttr(a,"data"));c.hasClass(a,"checked")?"radio"===this.inputType?this.runtime||"predefined"!==this.controlType?this.emit("advancedListValueSelect_itemChecked",b):this.emit("advancedListValueSelect_itemCheckedForPredefined",
d,b):(c.removeClass(a,"checked"),this._updateCheckedList("remove",d,b),this.emit("advancedListValueSelect_itemUnChecked",b)):("radio"===this.inputType&&this.currentItem&&(!0===this.currentItem&&(this.currentItem=this.getCurrentItem()),this.currentItem&&c.removeClass(this.currentItem,"checked")),c.addClass(a,"checked"),this.currentItem=a,this._updateCheckedList("add",d,b),this.runtime||"predefined"!==this.controlType?this.emit("advancedListValueSelect_itemChecked",b):this.emit("advancedListValueSelect_itemCheckedForPredefined",
d,b))},initDoms:function(a,b){this.setCBXData(a,b)},getData:function(){},refreshData:function(){this.checkCBXItems()},validate:function(){var a=this.checkedList.length?"12345678":null;1===this.checkedList.length&&this.checkedList[0]===this.emptyStr&&(a=null);if(this.isNumberField)for(var b=0;b<this.checkedList.length;b++){var c=this.checkedList[b];if(c!==this.emptyStr&&isNaN(c)){a=null;break}}this.set("DisplayedValue",a);return!0},setRequired:function(a){this.mutiValuesSelect.set("required",a)},destroy:function(){c.destroy(this.domNode);
this.inherited(arguments)}})});